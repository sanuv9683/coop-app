"use strict";(self.webpackChunkcoop_app=self.webpackChunkcoop_app||[]).push([[156],{9156:(j,p,d)=>{d.r(p),d.d(p,{DashboardModule:()=>y});var u=d(177),h=d(6143),m=d(467),e=d(540),i=d(5510);let f=(()=>{class o{constructor(t){this.firestore=t}addSale(t){const s=(0,i.rJ)(this.firestore,"sales");return(0,i.gS)(s,t)}getSales(t,s){var a=this;return(0,m.A)(function*(){const l=(0,i.rJ)(a.firestore,"sales");let n=(0,i.P)(l,(0,i._M)("date",">=",t));return s&&"All"!==s&&(n=(0,i.P)(n,(0,i._M)("store","==",s))),(yield(0,i.GG)(n)).docs.map(k=>k.data())})()}static{this.\u0275fac=function(s){return new(s||o)(e.KVO(i._7))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var r=d(4341);function F(o,g){if(1&o&&(e.j41(0,"p",13),e.EFF(1),e.k0s()),2&o){const t=e.XpG();e.R7$(1),e.JRh(t.message)}}function S(o,g){if(1&o&&(e.j41(0,"li",14),e.EFF(1),e.k0s()),2&o){const t=g.$implicit;e.R7$(1),e.E5c(" ",t.college," (",t.store,") - ",t.cardsSold," cards ")}}function M(o,g){if(1&o&&(e.j41(0,"li",17),e.EFF(1),e.k0s()),2&o){const t=g.$implicit;e.R7$(1),e.Lme(" ",t.name," - ",t.total," cards ")}}const v=[{path:"manager",component:(()=>{class o{constructor(t){this.salesService=t,this.store="East Barnet",this.college="",this.message="",this.todaySales=[]}ngOnInit(){this.loadTodaySales()}submitSale(){var t=this;return(0,m.A)(function*(){t.college&&t.cardsSold?(yield t.salesService.addSale({store:t.store,college:t.college,cardsSold:t.cardsSold,date:(new Date).toISOString().split("T")[0]}),t.message="Sale submitted successfully!",t.college="",t.cardsSold=NaN,t.loadTodaySales()):alert("Please fill out all fields.")})()}loadTodaySales(){var t=this;return(0,m.A)(function*(){const s=(new Date).toISOString().split("T")[0];t.todaySales=yield t.salesService.getSales(s)})()}static{this.\u0275fac=function(s){return new(s||o)(e.rXU(f))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-manager"]],decls:21,vars:5,consts:[[1,"container","mt-5"],[1,"mb-4"],[1,"card","p-4","shadow-sm","mb-4"],[1,"form-select","mb-3",3,"ngModel","ngModelChange"],["value","East Barnet"],["value","Wood House"],["type","text","placeholder","College Name",1,"form-control","mb-3",3,"ngModel","ngModelChange"],["type","number","placeholder","Cards Sold",1,"form-control","mb-3",3,"ngModel","ngModelChange"],[1,"btn","btn-success",3,"click"],["class","text-success mt-2",4,"ngIf"],[1,"card","p-4","shadow-sm"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"text-success","mt-2"],[1,"list-group-item"]],template:function(s,a){1&s&&(e.j41(0,"div",0)(1,"h3",1),e.EFF(2,"Manager Dashboard"),e.k0s(),e.j41(3,"div",2)(4,"h5"),e.EFF(5,"Add Sales Entry"),e.k0s(),e.j41(6,"select",3),e.bIt("ngModelChange",function(n){return a.store=n}),e.j41(7,"option",4),e.EFF(8,"East Barnet"),e.k0s(),e.j41(9,"option",5),e.EFF(10,"Wood House"),e.k0s()(),e.j41(11,"input",6),e.bIt("ngModelChange",function(n){return a.college=n}),e.k0s(),e.j41(12,"input",7),e.bIt("ngModelChange",function(n){return a.cardsSold=n}),e.k0s(),e.j41(13,"button",8),e.bIt("click",function(){return a.submitSale()}),e.EFF(14,"Submit"),e.k0s(),e.DNE(15,F,2,1,"p",9),e.k0s(),e.j41(16,"div",10)(17,"h5"),e.EFF(18,"Today's Sales"),e.k0s(),e.j41(19,"ul",11),e.DNE(20,S,2,3,"li",12),e.k0s()()()),2&s&&(e.R7$(6),e.Y8G("ngModel",a.store),e.R7$(5),e.Y8G("ngModel",a.college),e.R7$(1),e.Y8G("ngModel",a.cardsSold),e.R7$(3),e.Y8G("ngIf",a.message),e.R7$(5),e.Y8G("ngForOf",a.todaySales))},dependencies:[u.Sq,u.bT,r.xH,r.y7,r.me,r.Q0,r.wz,r.BC,r.vS]})}}return o})()},{path:"leaderboard",component:(()=>{class o{constructor(t){this.salesService=t,this.storeFilter="All",this.timeFilter="day",this.leaderboard=[]}loadLeaderboard(){var t=this;return(0,m.A)(function*(){const s=t.getStartDate(t.timeFilter),a=yield t.salesService.getSales(s,t.storeFilter),l={};for(const n of a){const c=n.college;l[c]||(l[c]=0),l[c]+=n.cardsSold}t.leaderboard=Object.entries(l).map(([n,c])=>({name:n,total:c})).sort((n,c)=>c.total-n.total)})()}getStartDate(t){const s=new Date;let a=new Date;switch(t){case"week":a.setDate(s.getDate()-7);break;case"month":a.setMonth(s.getMonth()-1);break;case"year":a.setFullYear(s.getFullYear()-1)}return a.toISOString().split("T")[0]}static{this.\u0275fac=function(s){return new(s||o)(e.rXU(f))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-leaderboard"]],decls:31,vars:3,consts:[[1,"container","mt-5"],[1,"mb-4"],[1,"card","p-4","shadow-sm","mb-4"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-select",3,"ngModel","ngModelChange"],["value","East Barnet"],["value","Wood House"],["value","All"],["value","day"],["value","week"],["value","month"],["value","year"],[1,"btn","btn-primary","w-100",3,"click"],[1,"card","p-4","shadow-sm"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"]],template:function(s,a){1&s&&(e.j41(0,"div",0)(1,"h3",1),e.EFF(2,"Sales Leaderboard"),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"select",5),e.bIt("ngModelChange",function(n){return a.storeFilter=n}),e.j41(7,"option",6),e.EFF(8,"East Barnet"),e.k0s(),e.j41(9,"option",7),e.EFF(10,"Wood House"),e.k0s(),e.j41(11,"option",8),e.EFF(12,"All Stores"),e.k0s()()(),e.j41(13,"div",4)(14,"select",5),e.bIt("ngModelChange",function(n){return a.timeFilter=n}),e.j41(15,"option",9),e.EFF(16,"Today"),e.k0s(),e.j41(17,"option",10),e.EFF(18,"This Week"),e.k0s(),e.j41(19,"option",11),e.EFF(20,"This Month"),e.k0s(),e.j41(21,"option",12),e.EFF(22,"This Year"),e.k0s()()(),e.j41(23,"div",4)(24,"button",13),e.bIt("click",function(){return a.loadLeaderboard()}),e.EFF(25,"Show Rankings"),e.k0s()()()(),e.j41(26,"div",14)(27,"h5"),e.EFF(28,"Top Sellers"),e.k0s(),e.j41(29,"ul",15),e.DNE(30,M,2,2,"li",16),e.k0s()()()),2&s&&(e.R7$(6),e.Y8G("ngModel",a.storeFilter),e.R7$(8),e.Y8G("ngModel",a.timeFilter),e.R7$(16),e.Y8G("ngForOf",a.leaderboard))},dependencies:[u.Sq,r.xH,r.y7,r.wz,r.BC,r.vS]})}}return o})()}];let C=(()=>{class o{static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[h.iI.forChild(v),h.iI]})}}return o})(),y=(()=>{class o{static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[u.MD,C,r.YN]})}}return o})()}}]);